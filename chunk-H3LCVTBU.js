import{a as J,b as S}from"./chunk-M2W6QF6I.js";import{a as K}from"./chunk-F2DZTHDP.js";import{a as V,b as j,c as L,d as W,e as R,f as z,g as B,h as q,i as G,j as Y,k as H}from"./chunk-GZPYKXTC.js";import{l as I}from"./chunk-4AF5SF7N.js";import{i as F,j as N,l as T}from"./chunk-O4Q2FRRA.js";import{$ as h,$a as c,Da as U,Ea as D,Ia as v,R as O,Ta as m,Ua as e,Va as t,Wa as w,Xa as E,_ as g,_a as f,bb as k,cb as i,d as y,db as u,eb as M,fb as A,gb as b,hb as _,ib as C,sa as o,xa as P}from"./chunk-4ZNG45L6.js";var Q=(()=>{let l=class l{};l.\u0275fac=function(r){return new(r||l)},l.\u0275mod=D({type:l}),l.\u0275inj=O({imports:[S,S]});let d=l;return d})();function Z(d,l){if(d&1&&(e(0,"div",31)(1,"h4"),i(2),t(),e(3,"span",32),i(4),t()()),d&2){let s=l.$implicit,a=c();o(2),u(s),o(2),M("",a.statistics.specialities[s]," m\xE9decin(s)")}}function $(d,l){if(d&1){let s=E();e(0,"div",36)(1,"label"),i(2,"Sp\xE9cialit\xE9"),t(),e(3,"select",45),C("ngModelChange",function(r){g(s);let n=c(2);return _(n.newUser.speciality,r)||(n.newUser.speciality=r),h(r)}),e(4,"option",46),i(5,"Cardiologie"),t(),e(6,"option",47),i(7,"Dermatologie"),t(),e(8,"option",48),i(9,"P\xE9diatrie"),t(),e(10,"option",49),i(11,"Neurologie"),t(),e(12,"option",50),i(13,"Orthop\xE9die"),t(),e(14,"option",51),i(15,"Gyn\xE9cologie"),t(),e(16,"option",52),i(17,"Psychiatrie"),t()()()}if(d&2){let s=c(2);o(3),b("ngModel",s.newUser.speciality)}}function ee(d,l){if(d&1){let s=E();e(0,"div",33)(1,"h3"),i(2,"Ajouter un nouvel utilisateur"),t(),e(3,"form",34),f("ngSubmit",function(){g(s);let r=c();return h(r.addUser())}),e(4,"div",35)(5,"div",36)(6,"label"),i(7,"Email"),t(),e(8,"input",37),C("ngModelChange",function(r){g(s);let n=c();return _(n.newUser.email,r)||(n.newUser.email=r),h(r)}),t()(),e(9,"div",36)(10,"label"),i(11,"Nom complet"),t(),e(12,"input",38),C("ngModelChange",function(r){g(s);let n=c();return _(n.newUser.displayName,r)||(n.newUser.displayName=r),h(r)}),t()()(),e(13,"div",35)(14,"div",36)(15,"label"),i(16,"Mot de passe"),t(),e(17,"input",39),C("ngModelChange",function(r){g(s);let n=c();return _(n.newUser.password,r)||(n.newUser.password=r),h(r)}),t()()(),e(18,"div",35)(19,"div",36)(20,"label"),i(21,"R\xF4le"),t(),e(22,"select",40),C("ngModelChange",function(r){g(s);let n=c();return _(n.newUser.role,r)||(n.newUser.role=r),h(r)}),e(23,"option",24),i(24,"Patient"),t(),e(25,"option",23),i(26,"M\xE9decin"),t()()(),v(27,$,18,1,"div",41),t(),e(28,"div",42)(29,"button",43),i(30),t(),e(31,"button",44),f("click",function(){g(s);let r=c();return h(r.cancelAddUser())}),i(32," Annuler "),t()()()()}if(d&2){let s=c();o(8),b("ngModel",s.newUser.email),o(4),b("ngModel",s.newUser.displayName),o(5),b("ngModel",s.newUser.password),o(5),b("ngModel",s.newUser.role),o(5),m("ngIf",s.newUser.role==="medecin"),o(2),m("disabled",s.isLoading),o(),M(" ",s.isLoading?"Ajout...":"Ajouter"," ")}}function te(d,l){if(d&1&&(e(0,"div",53)(1,"div",54),i(2),t(),e(3,"div",54),i(4),t(),e(5,"div",54)(6,"span",55),i(7),t()(),e(8,"div",54),i(9),t()()),d&2){let s=l.$implicit,a=c();o(2),u(s.displayName),o(2),u(s.email),o(2),k("role-"+s.role),o(),M(" ",a.getRoleDisplay(s.role)," "),o(2),u(s.speciality||"-")}}var pe=(()=>{let l=class l{get paginatedUsers(){let a=(this.currentPage-1)*this.usersPerPage;return this.filteredUsers.slice(a,a+this.usersPerPage)}get totalPages(){return Math.ceil(this.filteredUsers.length/this.usersPerPage)}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}prevPage(){this.currentPage>1&&this.currentPage--}constructor(a,r){this.userService=a,this.authService=r,this.statistics={totalUsers:0,totalDoctors:0,totalPatients:0,specialities:{}},this.users=[],this.filteredUsers=[],this.selectedRoleFilter="",this.showAddUserForm=!1,this.isLoading=!1,this.newUser={email:"",displayName:"",role:"patient",speciality:"",password:""},this.Object=Object,this.roleChartLabels=["Administrateurs","M\xE9decins","Patients"],this.roleChartData={labels:this.roleChartLabels,datasets:[{data:[0,0,0],backgroundColor:["#36A2EB","#FF6384","#FFCE56"]}]},this.roleChartType="pie",this.specialityChartLabels=[],this.specialityChartData={labels:[],datasets:[{label:"M\xE9decins par sp\xE9cialit\xE9",data:[],backgroundColor:"#42A5F5"}]},this.specialityChartType="bar",this.chartOptions={responsive:!0,plugins:{legend:{position:"top"}}},this.currentPage=1,this.usersPerPage=10}ngOnInit(){this.loadData()}loadData(){return y(this,null,function*(){try{this.statistics=yield this.userService.getStatistics(),this.users=yield this.userService.getAllUsers(),this.filteredUsers=this.users,this.updateCharts()}catch(a){console.error("Erreur lors du chargement des donn\xE9es:",a)}})}updateCharts(){let a=this.users.filter(p=>p.role==="admin").length,r=this.users.filter(p=>p.role==="medecin").length,n=this.users.filter(p=>p.role==="patient").length;this.roleChartData={labels:this.roleChartLabels,datasets:[{data:[a,r,n],backgroundColor:["#36A2EB","#FF6384","#FFCE56"]}]},this.specialityChartLabels=Object.keys(this.statistics.specialities);let x=Object.values(this.statistics.specialities);this.specialityChartData={labels:this.specialityChartLabels,datasets:[{label:"M\xE9decins par sp\xE9cialit\xE9",data:x,backgroundColor:"#42A5F5"}]}}filterUsers(){this.filteredUsers=this.selectedRoleFilter?this.users.filter(a=>a.role===this.selectedRoleFilter):this.users,this.currentPage=1}addUser(){return y(this,null,function*(){if(!this.newUser.email||!this.newUser.displayName){alert("Veuillez remplir tous les champs obligatoires");return}if(this.newUser.role==="medecin"&&!this.newUser.speciality){alert("Veuillez indiquer la sp\xE9cialit\xE9 pour un m\xE9decin");return}this.isLoading=!0;try{let a="password123",r={displayName:this.newUser.displayName,role:this.newUser.role};this.newUser.role==="medecin"&&(r.speciality=this.newUser.speciality),yield this.authService.signUp(this.newUser.email,a,r,!1),yield this.loadData(),this.cancelAddUser(),alert(`Utilisateur ajout\xE9 avec succ\xE8s !
Mot de passe par d\xE9faut : ${a}`)}catch(a){console.error("Erreur lors de l'ajout:",a),alert("Erreur lors de l'ajout de l'utilisateur")}finally{this.isLoading=!1}})}cancelAddUser(){this.showAddUserForm=!1,this.newUser={email:"",displayName:"",role:"patient",speciality:"",password:""}}deleteUser(a){return y(this,null,function*(){if(confirm("\xCAtes-vous s\xFBr de vouloir supprimer cet utilisateur?"))try{yield this.userService.deleteUser(a),yield this.loadData()}catch(r){console.error("Erreur lors de la suppression:",r),alert("Erreur lors de la suppression de l'utilisateur")}})}getRoleDisplay(a){switch(a){case"admin":return"Administrateur";case"medecin":return"M\xE9decin";case"patient":return"Patient";default:return a}}};l.\u0275fac=function(r){return new(r||l)(P(K),P(I))},l.\u0275cmp=U({type:l,selectors:[["app-admin-dashboard"]],decls:94,vars:20,consts:[[1,"admin-dashboard"],[1,"dashboard-header"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-icon"],[1,"stat-info"],[1,"charts-section"],[1,"charts-grid"],[1,"chart-card"],[1,"chart-container"],["baseChart","",3,"data","labels","type","options"],[1,"specialities-section"],[1,"specialities-grid"],["class","speciality-card",4,"ngFor","ngForOf"],[1,"users-section"],[1,"section-header"],[1,"add-btn",3,"click"],["class","add-user-form",4,"ngIf"],[1,"users-list"],[1,"users-filters"],[1,"filter-select",3,"ngModelChange","change","ngModel"],["value",""],["value","admin"],["value","medecin"],["value","patient"],[1,"users-table"],[1,"table-header"],[1,"header-cell"],["class","table-row",4,"ngFor","ngForOf"],[1,"pagination-controls"],[3,"click","disabled"],[1,"speciality-card"],[1,"speciality-count"],[1,"add-user-form"],[1,"user-form",3,"ngSubmit"],[1,"form-row"],[1,"form-group"],["type","email","name","email","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","text","name","displayName","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","password","name","password","required","","placeholder","Mot de passe",1,"form-input",3,"ngModelChange","ngModel"],["name","role","required","",1,"form-select",3,"ngModelChange","ngModel"],["class","form-group",4,"ngIf"],[1,"form-actions"],["type","submit",1,"submit-btn",3,"disabled"],["type","button",1,"cancel-btn",3,"click"],["name","speciality",1,"form-select",3,"ngModelChange","ngModel"],["value","Cardiologie"],["value","Dermatologie"],["value","P\xE9diatrie"],["value","Neurologie"],["value","Orthop\xE9die"],["value","Gyn\xE9cologie"],["value","Psychiatrie"],[1,"table-row"],[1,"table-cell"],[1,"role-badge"]],template:function(r,n){r&1&&(e(0,"div",0)(1,"div",1)(2,"h1"),i(3,"Tableau de bord administrateur"),t(),e(4,"p"),i(5,"G\xE9rez les utilisateurs et consultez les statistiques"),t()(),e(6,"div",2)(7,"div",3)(8,"div",4),i(9,"\u{1F465}"),t(),e(10,"div",5)(11,"h3"),i(12),t(),e(13,"p"),i(14,"Utilisateurs total"),t()()(),e(15,"div",3)(16,"div",4),i(17,"\u{1F468}\u200D\u2695\uFE0F"),t(),e(18,"div",5)(19,"h3"),i(20),t(),e(21,"p"),i(22,"M\xE9decins"),t()()(),e(23,"div",3)(24,"div",4),i(25,"\u{1F3E5}"),t(),e(26,"div",5)(27,"h3"),i(28),t(),e(29,"p"),i(30,"Patients"),t()()(),e(31,"div",3)(32,"div",4),i(33,"\u{1F4CA}"),t(),e(34,"div",5)(35,"h3"),i(36),t(),e(37,"p"),i(38,"Sp\xE9cialit\xE9s"),t()()()(),e(39,"div",6)(40,"h2"),i(41,"Statistiques visuelles"),t(),e(42,"div",7)(43,"div",8)(44,"h3"),i(45,"R\xE9partition des r\xF4les"),t(),e(46,"div",9),w(47,"canvas",10),t()(),e(48,"div",8)(49,"h3"),i(50,"M\xE9decins par sp\xE9cialit\xE9"),t(),e(51,"div",9),w(52,"canvas",10),t()()()(),e(53,"div",11)(54,"h2"),i(55,"R\xE9partition par sp\xE9cialit\xE9"),t(),e(56,"div",12),v(57,Z,5,2,"div",13),t()(),e(58,"div",14)(59,"div",15)(60,"h2"),i(61,"Gestion des utilisateurs"),t(),e(62,"button",16),f("click",function(){return n.showAddUserForm=!0}),i(63," Ajouter un utilisateur "),t()(),v(64,ee,33,7,"div",17),e(65,"div",18)(66,"div",19)(67,"select",20),C("ngModelChange",function(p){return _(n.selectedRoleFilter,p)||(n.selectedRoleFilter=p),p}),f("change",function(){return n.filterUsers()}),e(68,"option",21),i(69,"Tous les r\xF4les"),t(),e(70,"option",22),i(71,"Administrateur"),t(),e(72,"option",23),i(73,"M\xE9decin"),t(),e(74,"option",24),i(75,"Patient"),t()()(),e(76,"div",25)(77,"div",26)(78,"div",27),i(79,"Nom"),t(),e(80,"div",27),i(81,"Email"),t(),e(82,"div",27),i(83,"R\xF4le"),t(),e(84,"div",27),i(85,"Sp\xE9cialit\xE9"),t()(),v(86,te,10,6,"div",28),t(),e(87,"div",29)(88,"button",30),f("click",function(){return n.prevPage()}),i(89,"Pr\xE9c\xE9dent"),t(),e(90,"span"),i(91),t(),e(92,"button",30),f("click",function(){return n.nextPage()}),i(93,"Suivant"),t()()()()()),r&2&&(o(12),u(n.statistics.totalUsers),o(8),u(n.statistics.totalDoctors),o(8),u(n.statistics.totalPatients),o(8),u(n.Object.keys(n.statistics.specialities).length),o(11),m("data",n.roleChartData)("labels",n.roleChartLabels)("type",n.roleChartType)("options",n.chartOptions),o(5),m("data",n.specialityChartData)("labels",n.specialityChartLabels)("type",n.specialityChartType)("options",n.chartOptions),o(5),m("ngForOf",n.Object.keys(n.statistics.specialities)),o(7),m("ngIf",n.showAddUserForm),o(3),b("ngModel",n.selectedRoleFilter),o(19),m("ngForOf",n.paginatedUsers),o(2),m("disabled",n.currentPage===1),o(3),A("Page ",n.currentPage," / ",n.totalPages),o(),m("disabled",n.currentPage===n.totalPages))},dependencies:[T,F,N,H,z,q,G,V,B,j,L,Y,R,W,Q,J],styles:[".admin-dashboard[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;padding:2rem;background-color:#f5f7fa;color:#333}.dashboard-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;color:#2c3e50}.dashboard-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-bottom:2rem}.stat-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 4px 12px #0000000d;display:flex;align-items:center;gap:1rem}.stat-icon[_ngcontent-%COMP%]{font-size:2.5rem}.stat-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.8rem;color:#2c3e50}.stat-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#7f8c8d}.charts-section[_ngcontent-%COMP%]{margin-bottom:3rem}.charts-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;justify-content:center}.chart-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;padding:1rem;box-shadow:0 4px 10px #0000000d;width:100%;max-width:450px}.chart-container[_ngcontent-%COMP%]{position:relative;width:100%;height:280px}.specialities-section[_ngcontent-%COMP%]{margin-top:3rem}.specialities-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2c3e50;font-size:1.5rem}.specialities-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem}.speciality-card[_ngcontent-%COMP%]{background-color:#fff;border-left:6px solid #3498db;padding:1rem;border-radius:12px;box-shadow:0 4px 8px #0000000d;text-align:left;transition:transform .2s ease}.speciality-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.speciality-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:#2c3e50}.speciality-count[_ngcontent-%COMP%]{font-size:.9rem;color:#7f8c8d;margin-top:.3rem;display:block}.users-section[_ngcontent-%COMP%]{margin-top:2rem}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.add-btn[_ngcontent-%COMP%]{background-color:#27ae60;color:#fff;padding:.5rem 1rem;border-radius:8px;border:none;cursor:pointer;transition:background .3s}.add-btn[_ngcontent-%COMP%]:hover{background-color:#219150}.add-user-form[_ngcontent-%COMP%]{background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 6px #0000000f;margin-bottom:2rem}.user-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{padding:.6rem;border:1px solid #ccc;border-radius:6px}.form-actions[_ngcontent-%COMP%]{margin-top:1rem;display:flex;gap:1rem}.submit-btn[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff;padding:.6rem 1.2rem;border:none;border-radius:8px;cursor:pointer}.submit-btn[_ngcontent-%COMP%]:hover{background-color:#216f9c}.cancel-btn[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;padding:.6rem 1.2rem;border:none;border-radius:8px;cursor:pointer}.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#c0392b}.users-filters[_ngcontent-%COMP%]{margin-bottom:1rem}.filter-select[_ngcontent-%COMP%]{padding:.5rem;border-radius:6px;border:1px solid #ccc}.users-table[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;overflow-x:auto;box-shadow:0 2px 6px #0000000a}.table-header[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);padding:.8rem;border-bottom:1px solid #eee}.table-header[_ngcontent-%COMP%]{background-color:#ecf0f1;font-weight:700}.table-cell[_ngcontent-%COMP%]{padding:.3rem}.role-badge[_ngcontent-%COMP%]{padding:.2rem .5rem;border-radius:6px;font-size:.85rem;color:#fff}.role-admin[_ngcontent-%COMP%]{background-color:#9b59b6}.role-medecin[_ngcontent-%COMP%]{background-color:#3498db}.role-patient[_ngcontent-%COMP%]{background-color:#1abc9c}.delete-btn[_ngcontent-%COMP%]{background-color:#e74c3c;border:none;color:#fff;padding:.4rem .8rem;border-radius:6px;cursor:pointer;font-size:.85rem}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#c0392b}.pagination-controls[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1rem;margin-top:1rem}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:.5rem 1rem;border-radius:5px;cursor:pointer}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}"]});let d=l;return d})();export{pe as AdminDashboardComponent};
