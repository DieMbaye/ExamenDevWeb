import{a as j,b as D,c as v,d as F,e as V,f as L}from"./chunk-M6XDCT5R.js";import{a as $}from"./chunk-YPS6JUFR.js";import{l as p}from"./chunk-4AF5SF7N.js";import{i as H,j as O,k as R,l as P}from"./chunk-O4Q2FRRA.js";import{$ as y,$a as f,Da as M,Ia as m,Q as x,Ta as l,U as h,Ua as o,Va as a,Wa as A,Xa as k,_ as b,_a as C,ab as z,cb as s,d as _,db as u,kb as w,lb as N,nb as U,sa as c,xa as g}from"./chunk-4ZNG45L6.js";var K=()=>["/admin"],Q=()=>["/doctor"],W=()=>["/patient"];function X(t,e){t&1&&(o(0,"li")(1,"a",10),s(2,"Tableau de bord"),a()()),t&2&&(c(),l("routerLink",w(1,K)))}function Z(t,e){t&1&&(o(0,"li")(1,"a",10),s(2,"Mes rendez-vous"),a()()),t&2&&(c(),l("routerLink",w(1,Q)))}function tt(t,e){t&1&&(o(0,"li")(1,"a",10),s(2,"Mon dossier"),a()()),t&2&&(c(),l("routerLink",w(1,W)))}function et(t,e){if(t&1&&(o(0,"span",16),s(1),a()),t&2){let r=f(2);c(),u(r.unreadCount)}}function it(t,e){if(t&1){let r=k();o(0,"div",23),C("click",function(){let n=b(r).$implicit,d=f(3);return y(d.markAsRead(n.id))}),o(1,"h4"),s(2),a(),o(3,"p"),s(4),a(),o(5,"small"),s(6),N(7,"date"),a()()}if(t&2){let r=e.$implicit;z("unread",!r.read),c(2),u(r.title),c(2),u(r.message),c(2),u(U(7,5,r.createdAt,"short","fr"))}}function nt(t,e){t&1&&(o(0,"div",24),s(1," Aucune notification "),a())}function ot(t,e){if(t&1){let r=k();o(0,"div",17)(1,"div",18)(2,"h3"),s(3,"Notifications"),a(),o(4,"button",19),C("click",function(){b(r);let n=f(2);return y(n.markAllAsRead())}),s(5,"Tout marquer comme lu"),a()(),o(6,"div",20),m(7,it,8,9,"div",21)(8,nt,2,0,"div",22),a()()}if(t&2){let r=f(2);c(7),l("ngForOf",r.notifications),c(),l("ngIf",r.notifications.length===0)}}function rt(t,e){if(t&1){let r=k();o(0,"div",11)(1,"button",12),C("click",function(){b(r);let n=f();return y(n.toggleNotifications())}),o(2,"span",13),s(3,"\u{1F514}"),a(),m(4,et,2,1,"span",14),a(),m(5,ot,9,2,"div",15),a()}if(t&2){let r=f();c(4),l("ngIf",r.unreadCount>0),c(),l("ngIf",r.showNotifications)}}function at(t,e){if(t&1&&(o(0,"div",25)(1,"span",26),s(2),a(),o(3,"span",27),s(4),a()()),t&2){let r=f();c(2),u(r.currentUser.displayName),c(2),u(r.getRoleDisplay(r.currentUser.role))}}var B=(()=>{let e=class e{constructor(i,n,d){this.authService=i,this.notificationService=n,this.router=d,this.currentUser=null,this.notifications=[],this.unreadCount=0,this.showNotifications=!1,this.authChecked=!1}ngOnInit(){this.authService.authChecked$.subscribe(i=>{this.authChecked=i}),this.authService.currentUser$.subscribe(i=>{this.authChecked&&(this.currentUser=i,i?this.loadNotifications():(this.notifications=[],this.unreadCount=0))})}loadNotifications(){return _(this,null,function*(){if(this.currentUser)try{this.notifications=yield this.notificationService.getNotificationsByUser(this.currentUser.uid),this.unreadCount=this.notifications.filter(i=>!i.read).length}catch(i){console.error("Erreur lors du chargement des notifications:",i)}})}toggleNotifications(){this.showNotifications=!this.showNotifications}markAsRead(i){return _(this,null,function*(){try{yield this.notificationService.markAsRead(i),yield this.loadNotifications()}catch(n){console.error("Erreur lors du marquage comme lu:",n)}})}markAllAsRead(){return _(this,null,function*(){try{let i=this.notifications.filter(n=>!n.read);for(let n of i)yield this.notificationService.markAsRead(n.id);yield this.loadNotifications()}catch(i){console.error("Erreur lors du marquage global:",i)}})}getRoleDisplay(i){switch(i){case"admin":return"Administrateur";case"medecin":return"M\xE9decin";case"patient":return"Patient";default:return i}}logout(){return _(this,null,function*(){try{yield this.authService.signOut(),this.router.navigate(["/login"])}catch(i){console.error("Erreur lors de la d\xE9connexion:",i)}})}};e.\u0275fac=function(n){return new(n||e)(g(p),g($),g(v))},e.\u0275cmp=M({type:e,selectors:[["app-header"]],decls:15,vars:5,consts:[[1,"header"],[1,"header-content"],[1,"logo"],[1,"nav"],[1,"nav-list"],[4,"ngIf"],[1,"user-section"],["class","notifications",4,"ngIf"],["class","user-info",4,"ngIf"],[1,"logout-btn",3,"click"],[1,"nav-link",3,"routerLink"],[1,"notifications"],[1,"notification-btn",3,"click"],[1,"notification-icon"],["class","notification-count",4,"ngIf"],["class","notification-dropdown",4,"ngIf"],[1,"notification-count"],[1,"notification-dropdown"],[1,"notification-header"],[3,"click"],[1,"notification-list"],["class","notification-item",3,"unread","click",4,"ngFor","ngForOf"],["class","no-notifications",4,"ngIf"],[1,"notification-item",3,"click"],[1,"no-notifications"],[1,"user-info"],[1,"user-name"],[1,"user-role"]],template:function(n,d){n&1&&(o(0,"header",0)(1,"div",1)(2,"div",2)(3,"h1"),s(4,"MediCare"),a()(),o(5,"nav",3)(6,"ul",4),m(7,X,3,2,"li",5)(8,Z,3,2,"li",5)(9,tt,3,2,"li",5),a()(),o(10,"div",6),m(11,rt,6,2,"div",7)(12,at,5,2,"div",8),o(13,"button",9),C("click",function(){return d.logout()}),s(14," D\xE9connexion "),a()()()()),n&2&&(c(7),l("ngIf",(d.currentUser==null?null:d.currentUser.role)==="admin"),c(),l("ngIf",(d.currentUser==null?null:d.currentUser.role)==="medecin"),c(),l("ngIf",(d.currentUser==null?null:d.currentUser.role)==="patient"),c(2),l("ngIf",d.currentUser),c(),l("ngIf",d.currentUser))},dependencies:[P,H,O,R,L,F],styles:[".header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2563eb,#1d4ed8);color:#fff;padding:1rem 0;box-shadow:0 2px 10px #0000001a}.header-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;justify-content:space-between;align-items:center}.logo[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.8rem;font-weight:700}.nav-list[_ngcontent-%COMP%]{display:flex;list-style:none;margin:0;padding:0;gap:2rem}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-weight:500;transition:opacity .2s}.nav-link[_ngcontent-%COMP%]:hover{opacity:.8}.user-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;position:relative}.notifications[_ngcontent-%COMP%]{position:relative}.notification-btn[_ngcontent-%COMP%]{background:#ffffff1a;border:none;color:#fff;padding:.5rem;border-radius:.5rem;cursor:pointer;position:relative;transition:background .2s}.notification-btn[_ngcontent-%COMP%]:hover{background:#fff3}.notification-count[_ngcontent-%COMP%]{position:absolute;top:-.5rem;right:-.5rem;background:#ef4444;color:#fff;border-radius:50%;width:1.5rem;height:1.5rem;display:flex;align-items:center;justify-content:center;font-size:.8rem;font-weight:700}.notification-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;color:#000;border-radius:.5rem;box-shadow:0 10px 30px #0003;width:350px;max-height:400px;overflow-y:auto;z-index:1000;margin-top:.5rem}.notification-header[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}.notification-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem}.notification-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#2563eb;cursor:pointer;font-size:.9rem}.notification-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.notification-item[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #f3f4f6;cursor:pointer;transition:background .2s}.notification-item[_ngcontent-%COMP%]:hover{background:#f9fafb}.notification-item.unread[_ngcontent-%COMP%]{background:#eff6ff;border-left:4px solid #2563eb}.notification-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.95rem;font-weight:600}.notification-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.9rem;color:#6b7280}.notification-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#9ca3af;font-size:.8rem}.no-notifications[_ngcontent-%COMP%]{padding:2rem;text-align:center;color:#6b7280}.user-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:right}.user-name[_ngcontent-%COMP%]{font-weight:600;font-size:.95rem}.user-role[_ngcontent-%COMP%]{font-size:.8rem;opacity:.8}.logout-btn[_ngcontent-%COMP%]{background:#ffffff1a;border:1px solid rgba(255,255,255,.3);color:#fff;padding:.5rem 1rem;border-radius:.5rem;cursor:pointer;transition:all .2s;font-size:.9rem}.logout-btn[_ngcontent-%COMP%]:hover{background:#fff3;transform:translateY(-1px)}@media (max-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.nav-list[_ngcontent-%COMP%]{gap:1rem}.notification-dropdown[_ngcontent-%COMP%]{width:300px}}"]});let t=e;return t})();function ct(t,e){t&1&&A(0,"app-header")}var Y=(()=>{let e=class e{constructor(i){this.authService=i,this.showHeader=!1}ngOnInit(){this.authService.currentUser$.subscribe(i=>{this.showHeader=!!i}),this.authService.initializeAdmin()}};e.\u0275fac=function(n){return new(n||e)(g(p))},e.\u0275cmp=M({type:e,selectors:[["app-root"]],decls:4,vars:1,consts:[[1,"app"],[4,"ngIf"],[1,"main-content"]],template:function(n,d){n&1&&(o(0,"div",0),m(1,ct,1,0,"app-header",1),o(2,"main",2),A(3,"router-outlet"),a()()),n&2&&(c(),l("ngIf",d.showHeader))},dependencies:[P,O,D,B],styles:[".app[_ngcontent-%COMP%]{min-height:100vh;background:#f3f4f6}.main-content[_ngcontent-%COMP%]{min-height:calc(100vh - 80px)}.unauthorized[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100vh;font-size:1.5rem;color:#ef4444;background:#fef2f2}"]});let t=e;return t})();var S=(()=>{let e=class e{constructor(i,n){this.authService=i,this.router=n}canActivate(){return this.authService.isAuthenticated()?!0:(this.router.navigate(["/login"]),!1)}};e.\u0275fac=function(n){return new(n||e)(h(p),h(v))},e.\u0275prov=x({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var I=(()=>{let e=class e{constructor(i,n){this.authService=i,this.router=n}canActivate(i){let n=i.data.role;return this.authService.hasRole(n)?!0:(this.router.navigate(["/unauthorized"]),!1)}};e.\u0275fac=function(n){return new(n||e)(h(p),h(v))},e.\u0275prov=x({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var G=[{path:"",loadComponent:()=>import("./chunk-2FR4V7JJ.js").then(t=>t.AccueilComponent)},{path:"login",loadComponent:()=>import("./chunk-5HC4FXAO.js").then(t=>t.LoginComponent)},{path:"admin",loadComponent:()=>import("./chunk-H3LCVTBU.js").then(t=>t.AdminDashboardComponent),canActivate:[S,I],data:{role:"admin"}},{path:"doctor",loadComponent:()=>import("./chunk-4R77BIUK.js").then(t=>t.DoctorDashboardComponent),canActivate:[S,I],data:{role:"medecin"}},{path:"patient",loadComponent:()=>import("./chunk-XX72V7QQ.js").then(t=>t.PatientDashboardComponent),canActivate:[S,I],data:{role:"patient"}},{path:"unauthorized",loadComponent:()=>import("./chunk-KVWV25HG.js").then(t=>t.UnauthorizedComponent)},{path:"**",redirectTo:""}];j(Y,{providers:[V(G)]}).catch(t=>console.error(t));
